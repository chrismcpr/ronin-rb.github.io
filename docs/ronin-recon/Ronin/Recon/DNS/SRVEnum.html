<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Ronin::Recon::DNS::SRVEnum
  
    &mdash; Ronin::Recon Documentation
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Ronin::Recon::DNS::SRVEnum";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Ronin.html" title="Ronin (module)">Ronin</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Recon.html" title="Ronin::Recon (module)">Recon</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../DNS.html" title="Ronin::Recon::DNS (module)">DNS</a></span></span>
     &raquo; 
    <span class="title">SRVEnum</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Ronin::Recon::DNS::SRVEnum
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../DNSWorker.html" title="Ronin::Recon::DNSWorker (class)">Ronin::Recon::DNSWorker</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="../Worker.html" title="Ronin::Recon::Worker (class)">Worker</a></span></li>
          
            <li class="next"><span class='object_link'><a href="../DNSWorker.html" title="Ronin::Recon::DNSWorker (class)">Ronin::Recon::DNSWorker</a></span></li>
          
            <li class="next">Ronin::Recon::DNS::SRVEnum</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/ronin/recon/builtin/dns/srv_enum.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>Finds other host names by querying common <code>SRV</code> record names under a
domain.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="RECORD_NAMES-constant" class="">RECORD_NAMES =
          <div class="docstring">
  <div class="discussion">
    <p>Common <code>SRV</code> record names.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_gc._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_kerberos._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_kerberos._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_ldap._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_test._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_sips._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_sip._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_sip._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_aix._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_aix._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_finger._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_ftp._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_http._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_nntp._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_telnet._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_whois._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_h323cs._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_h323cs._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_h323be._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_h323be._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_h323ls._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_https._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_h323ls._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_sipinternal._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_sipinternaltls._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_sip._tls</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_sipfederationtls._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_jabber._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_xmpp-server._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_xmpp-client._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_xmpp-server._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_xmpp-client._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_imap.tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_certificates._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_crls._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_pgpkeys._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_pgprevokations._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_cmp._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_svcp._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_crl._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_ocsp._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_PKIXREP._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_smtp._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_hkp._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_hkps._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_jabber._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_jabber-client._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_jabber-client._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_kerberos.tcp.dc._msdcs</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_ldap._tcp.ForestDNSZones</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_ldap._tcp.dc._msdcs</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_ldap._tcp.pdc._msdcs</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_ldap._tcp.gc._msdcs</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_kerberos._tcp.dc._msdcs</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_kpasswd._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_kpasswd._udp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_imap._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_imaps._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_submission._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_pop3._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_pop3s._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_caldav._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_caldavs._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_carddav._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_carddavs._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_x-puppet._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_x-puppet-ca._tcp</span><span class='words_sep'>
</span><span class='words_sep'>  </span><span class='tstring_content'>_autodiscover._tcp</span><span class='words_sep'>
</span><span class='tstring_end'>]</span></span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="../Mixins/DNS.html" title="Ronin::Recon::Mixins::DNS (module)">Mixins::DNS</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Mixins/DNS.html#IDN-constant" title="Ronin::Recon::Mixins::DNS::IDN (constant)">Mixins::DNS::IDN</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#RECORD_TYPES-constant" title="Ronin::Recon::Mixins::DNS::RECORD_TYPES (constant)">Mixins::DNS::RECORD_TYPES</a></span></p>




  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes included from <span class='object_link'><a href="../Mixins/DNS.html" title="Ronin::Recon::Mixins::DNS (module)">Mixins::DNS</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Mixins/DNS.html#dns_resolver-instance_method" title="Ronin::Recon::Mixins::DNS#dns_resolver (method)">#dns_resolver</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#process-instance_method" title="#process (instance method)">#<strong>process</strong>(domain) {|host| ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Bruteforce resolves common <code>SRV</code> records for a domain.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Mixins/DNS.html" title="Ronin::Recon::Mixins::DNS (module)">Mixins::DNS</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Mixins/DNS.html#dns_get_a_address-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_a_address (method)">#dns_get_a_address</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_a_addresses-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_a_addresses (method)">#dns_get_a_addresses</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_a_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_a_record (method)">#dns_get_a_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_a_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_a_records (method)">#dns_get_a_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_aaaa_address-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_aaaa_address (method)">#dns_get_aaaa_address</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_aaaa_addresses-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_aaaa_addresses (method)">#dns_get_aaaa_addresses</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_aaaa_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_aaaa_record (method)">#dns_get_aaaa_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_aaaa_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_aaaa_records (method)">#dns_get_aaaa_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_address-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_address (method)">#dns_get_address</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_addresses-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_addresses (method)">#dns_get_addresses</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_any_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_any_records (method)">#dns_get_any_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_cname-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_cname (method)">#dns_get_cname</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_cname_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_cname_record (method)">#dns_get_cname_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_hinfo_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_hinfo_record (method)">#dns_get_hinfo_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_loc_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_loc_record (method)">#dns_get_loc_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_mailservers-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_mailservers (method)">#dns_get_mailservers</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_minfo_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_minfo_record (method)">#dns_get_minfo_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_mx_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_mx_records (method)">#dns_get_mx_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_name-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_name (method)">#dns_get_name</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_names-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_names (method)">#dns_get_names</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_nameservers-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_nameservers (method)">#dns_get_nameservers</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_ns_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_ns_records (method)">#dns_get_ns_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_ptr_name-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_ptr_name (method)">#dns_get_ptr_name</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_ptr_names-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_ptr_names (method)">#dns_get_ptr_names</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_ptr_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_ptr_record (method)">#dns_get_ptr_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_ptr_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_ptr_records (method)">#dns_get_ptr_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_record (method)">#dns_get_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_records (method)">#dns_get_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_soa_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_soa_record (method)">#dns_get_soa_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_srv_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_srv_records (method)">#dns_get_srv_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_txt_record-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_txt_record (method)">#dns_get_txt_record</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_txt_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_txt_records (method)">#dns_get_txt_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_txt_string-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_txt_string (method)">#dns_get_txt_string</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_txt_strings-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_txt_strings (method)">#dns_get_txt_strings</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#dns_get_wks_records-instance_method" title="Ronin::Recon::Mixins::DNS#dns_get_wks_records (method)">#dns_get_wks_records</a></span>, <span class='object_link'><a href="../Mixins/DNS.html#initialize-instance_method" title="Ronin::Recon::Mixins::DNS#initialize (method)">#initialize</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="../Worker.html" title="Ronin::Recon::Worker (class)">Worker</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Worker.html#accepts-class_method" title="Ronin::Recon::Worker.accepts (method)">accepts</a></span>, <span class='object_link'><a href="../Worker.html#concurrency-class_method" title="Ronin::Recon::Worker.concurrency (method)">concurrency</a></span>, <span class='object_link'><a href="../Worker.html#initialize-instance_method" title="Ronin::Recon::Worker#initialize (method)">#initialize</a></span>, <span class='object_link'><a href="../Worker.html#intensity-class_method" title="Ronin::Recon::Worker.intensity (method)">intensity</a></span>, <span class='object_link'><a href="../Worker.html#outputs-class_method" title="Ronin::Recon::Worker.outputs (method)">outputs</a></span>, <span class='object_link'><a href="../Worker.html#register-class_method" title="Ronin::Recon::Worker.register (method)">register</a></span>, <span class='object_link'><a href="../Worker.html#run-class_method" title="Ronin::Recon::Worker.run (method)">run</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="process-instance_method">
  
    #<strong>process</strong>(domain) {|host| ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Bruteforce resolves common <code>SRV</code> records for a domain.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>domain</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Values/Domain.html" title="Ronin::Recon::Values::Domain (class)">Values::Domain</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The domain to query.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>host</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A discovered host from <code>SRV</code> record under the domain.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>host</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Values/Host.html" title="Ronin::Recon::Values::Host (class)">Values::Host</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A host name pointed to by a <code>SRV</code> record under the domain.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ronin/recon/builtin/dns/srv_enum.rb', line 134</span>

<span class='kw'>def</span> <span class='id identifier rubyid_process'>process</span><span class='lparen'>(</span><span class='id identifier rubyid_domain'>domain</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_wordlist'>wordlist</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#RECORD_NAMES-constant" title="Ronin::Recon::DNS::SRVEnum::RECORD_NAMES (constant)">RECORD_NAMES</a></span></span>
  <span class='id identifier rubyid_queue'>queue</span>    <span class='op'>=</span> <span class='const'>Async</span><span class='op'>::</span><span class='const'>LimitedQueue</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:concurrency</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='const'>Async</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='op'>|</span>
    <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_async'>async</span> <span class='kw'>do</span>
      <span class='comment'># populate the queue with SRV record names to query
</span>      <span class='id identifier rubyid_wordlist'>wordlist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
        <span class='id identifier rubyid_queue'>queue</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_domain'>domain</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>

      <span class='comment'># send stop messages for each sub-task
</span>      <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:concurrency</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_queue'>queue</span> <span class='op'>&lt;&lt;</span> <span class='kw'>nil</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># spawn the sub-tasks
</span>    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:concurrency</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_async'>async</span> <span class='kw'>do</span>
        <span class='kw'>while</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_queue'>queue</span><span class='period'>.</span><span class='id identifier rubyid_dequeue'>dequeue</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_records'>records</span> <span class='op'>=</span> <span class='id identifier rubyid_dns_get_srv_records'>dns_get_srv_records</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>

          <span class='id identifier rubyid_records'>records</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_record'>record</span><span class='op'>|</span>
            <span class='comment'># BUG: async-dns will return `CNAME` records for domains
</span>            <span class='comment'># with catch-all subdomain aliases.
</span>            <span class='kw'>if</span> <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Resolv</span><span class='op'>::</span><span class='const'>DNS</span><span class='op'>::</span><span class='const'>Resource</span><span class='op'>::</span><span class='const'>IN</span><span class='op'>::</span><span class='const'>SRV</span><span class='rparen'>)</span>
              <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='id identifier rubyid_record'>record</span><span class='period'>.</span><span class='id identifier rubyid_target'>target</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
              <span class='id identifier rubyid_hostname'>hostname</span><span class='period'>.</span><span class='id identifier rubyid_chomp!'>chomp!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

              <span class='kw'>unless</span> <span class='id identifier rubyid_hostname'>hostname</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
                <span class='kw'>yield</span> <span class='const'><span class='object_link'><a href="../Values/Host.html" title="Ronin::Recon::Values::Host (class)">Host</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Values/Host.html#initialize-instance_method" title="Ronin::Recon::Values::Host#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
              <span class='kw'>end</span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Jul 22 13:56:20 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.36 (ruby-3.3.4).
</div>

    </div>
  </body>
</html>